# join buffer 无序数组

## 作用
加速join查询。

## 容量
每线程一个
由参数 join_buffer_size 控制，默认值是 256k

## 使用策略
- 在BNL算法中
    - 驱动表数据小于join_buffer_size

      ```
      1. 将按条件筛选完的驱动表数据放入join buffer中。
      2. 扫描被驱动表数据，用被驱动表的每一行数据与join buffer中的数据做对比，满足join条件的，作为结果集的一部分返回。
      ```
    - 驱动表数据小于join_buffer_size
      
      ```
      1. 将按条件筛选完的驱动表分块。
      2. 顺序取一块儿数据放入join buffer中
      3. 扫描被驱动表数据，用被驱动表的每一行数据与join_buffer中的数据做对比，满足join条件的，作为结果集的一部分返回。
      4. 重复第2、3步，直到驱动表全部数据都匹配完。
      ```
- 在BKA算法中
  BKA算法是建立在被驱动表有索引的情况上的。
  
  ```
  1. 将按条件筛选完的驱动表索引放入join buffer中。
  2. 遍历join buffer中的数据，通过索引获取被驱动表的数据，放到结果集中。
  3. 驱动表数据通过MRR优化查出后，放入结果集中。
  ```

## 其他

### 驱动表
join时优先查询的表

### 被驱动表
join时不优先查询的表
